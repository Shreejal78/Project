<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Catch the Falling Objects Game</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #f0f0f0;
      font-family: Arial, sans-serif;
    }

    h1 {
      text-shadow: 0 0 10px darkcyan,
        0 0 20px cyan,
        0 0 30px lightcyan;
    }

    #gameCanvas {
      position: relative;
      display: block;
      background-color: #87CEEB;
      margin: 0 0 0 7px;
      padding: 0;
      border: 2px solid #000;
    }

    #score {
      font-size: 20px;
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
      position:absolute;
      top:150px;
      left:30px;
    }

    #game-over {
      font-size: 30px;
      text-align: center;
      color: red;
      display: none;
      position: absolute;
      left: 130px;
      top: 250px;
    }

    #restart-btn {
      position:absolute ;
      left:130px;
      bottom:200px;
      display: none;
      margin: 0 auto;
      padding: 10px 20px;
      font-size: 18px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #restart-btn:hover {
      background-color: #45a049;
    }

    .home {
      margin: 10px;
      padding: 7px;
      border: 2px solid black;
      border-radius: 50%;
      max-width: fit-content;
    }
  </style>
</head>

<body>
  <div class="home">
    <a href="games.html"><img src="home.png" alt="" style="height: 35px;width:35px;"></a>
  </div>
  <h1>Catch the falling objects!!</h1>
  <canvas id="gameCanvas" width="370" height="520"></canvas>
  <div id="score">Score: 0</div>
  <button id="restart-btn">Restart Game</button>

  <div id="game-over">Game Over! </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("score");
    const gameOverDisplay = document.getElementById("game-over");
    const restartBtn = document.getElementById("restart-btn");

    let basket;
    let fallingObjects;
    let score;
    let gameOver;

    // Initialize game state
    function initGame() {
      basket = {
        x: canvas.width / 2 - 30,
        y: canvas.height - 30,
        width: 70,
        height: 17,
      };
      fallingObjects = [];
      score = 0;
      gameOver = false;

      scoreDisplay.textContent = "Score: 0";
      gameOverDisplay.style.display = "none";
      restartBtn.style.display = "none";

      gameLoop();
    }

    function createFallingObject() {
      let size = Math.random() * 20 + 10;
      let x = Math.random() * (canvas.width - size);
      fallingObjects.push({ x, y: 0, size, speed: Math.random() * 2 + 2 });
    }

    function drawBasket() {
      ctx.fillStyle = "brown";
      ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
    }

    function drawFallingObjects() {
      fallingObjects.forEach(obj => {
        ctx.fillStyle = "orange";
        ctx.beginPath();
        ctx.arc(obj.x, obj.y, obj.size, 0, Math.PI * 2);
        ctx.fill();
      });
    }

    function updateFallingObjects() {
      fallingObjects.forEach(obj => {
        obj.y += obj.speed;

        // Check for collision with basket
        if (
          obj.y + obj.size > basket.y &&
          obj.x + obj.size > basket.x &&
          obj.x < basket.x + basket.width
        ) {
          score++;
          scoreDisplay.textContent = "Score: " + score;
          fallingObjects.splice(fallingObjects.indexOf(obj), 1); // Remove the caught object
        }

        // Check if the object falls off the screen
        if (obj.y > canvas.height) {
          gameOver = true;
        }
      });
    }

    function gameLoop() {
      if (gameOver) {
        gameOverDisplay.style.display = "block";
        restartBtn.style.display = "block"; // Show restart button
        return;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawBasket();
      drawFallingObjects();
      updateFallingObjects();

      requestAnimationFrame(gameLoop);
    }

    // Move the basket based on the mouse's x position (for desktop)
    canvas.addEventListener("mousemove", function(e) {
      let rect = canvas.getBoundingClientRect();
      let mouseX = e.clientX - rect.left;

      // Ensure the basket doesn't move outside the canvas
      if (mouseX >= 0 && mouseX <= canvas.width - basket.width) {
        basket.x = mouseX - basket.width / 2;
      }
    });

    // Move the basket based on the touch's x position (for mobile)
    canvas.addEventListener("touchmove", function(e) {
      let rect = canvas.getBoundingClientRect();
      let touchX = e.touches[0].clientX - rect.left;

      // Ensure the basket doesn't move outside the canvas
      if (touchX >= 0 && touchX <= canvas.width - basket.width) {
        basket.x = touchX - basket.width / 5;
      }
      e.preventDefault(); // Prevent scrolling while playing
    });

    // Restart the game when the restart button is clicked
    restartBtn.addEventListener("click", function() {
      initGame(); // Re-initialize the game state
    });

    // Generate new falling objects every second
    setInterval(createFallingObject, 1000);

    // Initialize and start the game
    initGame();
  </script>
</body>

</html>